<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HOI4 State Data Converter</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }

        input[type="text"]:focus {
            border-color: #007bff;
            outline: none;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .convert-btn {
            background-color: #007bff;
            color: white;
        }

        .convert-btn:hover {
            background-color: #0056b3;
        }

        .convert-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        .copy-btn {
            background-color: #28a745;
            color: white;
        }

        .copy-btn:hover {
            background-color: #1e7e34;
        }

        .clear-btn {
            background-color: #dc3545;
            color: white;
        }

        .clear-btn:hover {
            background-color: #c82333;
        }

        .file-input-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 5px;
            border: 2px dashed #dee2e6;
            margin-bottom: 20px;
        }

        .output-section {
            margin-top: 30px;
        }

        textarea {
            width: 100%;
            min-height: 400px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
            box-sizing: border-box;
            resize: vertical;
        }

        textarea:focus {
            border-color: #007bff;
            outline: none;
        }

        .status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
        }

        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .sample-download {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            border: 1px solid #dee2e6;
        }

        .sample-link {
            color: #007bff;
            text-decoration: none;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .sample-link:hover {
            color: #0056b3;
            text-decoration: underline;
        }

        .sample-description {
            color: #666;
            font-size: 14px;
            font-style: italic;
        }

        .status.info {
            background-color: #cce7ff;
            color: #004085;
            border: 1px solid #99d6ff;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .instructions {
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
            border-left: 4px solid #007bff;
        }

        .instructions h3 {
            margin-top: 0;
            color: #495057;
        }

        .instructions ul {
            margin-bottom: 0;
        }

        .code-example {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 3px;
            padding: 10px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            margin: 10px 0;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>HOI4 State Data Converter</h1>

        <div class="instructions">
            <h3>Step 1: Generate HOI4 Log Data</h3>
            <p>First, you need to run this HOI4 decision in your game to generate the log data that this converter needs. Add this decision to your mod's common/decisions folder:</p>
            <div class="code-example">
great_game_state_logger = {
    icon = generic_prepare_civil_war
    complete_effect = {
        every_country = {
            log = "--------------------------------"
            log = "[THIS.GetTag] claim states:"
            THIS = {
                every_owned_state = {
                    if = {
                        limit = {
                            not = { is_core_of = THIS}
                        }
                        log = "[state.GetID]"
                    }
                }
            }
            log = "--------------------------------"
            log = "[THIS.GetTag] core states:"
            THIS = {
                every_owned_state = {
                    if = {
                        limit = {
                            is_core_of = THIS
                        }
                        log = "[state.GetID]"
                    }
                }
            }
            log = "--------------------------------"
        }

    }
}
            </div>
            <p><strong>How to use:</strong> Add this decision to your mod, load it in HOI4, then execute the decision in-game. The game will output log data to your game.log file showing each country's claim states and core states.</p>
        </div>

        <div class="instructions">
            <h3>Step 2: Convert Log Data to JSON</h3>
            <ul>
                <li>Paste your cleaned HOI4 log file contents (without timestamps) into the text area below</li>
                <li>Click "Convert to JSON" to parse the data and generate JSON</li>
                <li>The output will be an array of country objects with claim_state and core_state arrays</li>
                <li>Use "Copy JSON" to copy the result to clipboard</li>
            </ul>
            <div class="code-example">
Example output format:
[{tag: "AST", claim_state: [634, 737, 757], core_state: [986,285,517,518,519,520,521,987,523,636,674,985,522,988]}, ...]
            </div>
        </div>

        <div class="form-group">
            <label for="pastedContent">Paste File Contents Here:</label>
            <div class="sample-download">
                <a href="#" id="downloadSampleBtn" class="sample-link">ðŸ“„ Download Sample Input File</a>
                <span class="sample-description">(Example file with real HOI4 state data)</span>
            </div>
            <textarea id="pastedContent" placeholder="Paste your cleaned HOI4 log file contents here..." style="min-height: 300px; resize: vertical;"></textarea>
        </div>

        <div class="button-group">
            <button id="convertBtn" class="convert-btn">Convert to JSON</button>
            <button id="copyBtn" class="copy-btn" disabled>Copy JSON</button>
            <button id="clearBtn" class="clear-btn">Clear</button>
        </div>

        <div id="statusMessage"></div>

        <div class="output-section">
            <label for="outputTextarea">JSON Output:</label>
            <textarea id="outputTextarea" readonly placeholder="Converted JSON will appear here..."></textarea>
        </div>
    </div>

    <script>
        class HOI4Converter {
            constructor() {
                this.convertBtn = document.getElementById('convertBtn');
                this.copyBtn = document.getElementById('copyBtn');
                this.clearBtn = document.getElementById('clearBtn');
                this.pastedContentTextarea = document.getElementById('pastedContent');
                this.outputTextarea = document.getElementById('outputTextarea');
                this.statusMessage = document.getElementById('statusMessage');
                this.downloadSampleBtn = document.getElementById('downloadSampleBtn');

                this.initEventListeners();
            }

            initEventListeners() {
                this.convertBtn.addEventListener('click', () => this.convertContent());
                this.copyBtn.addEventListener('click', () => this.copyToClipboard());
                this.clearBtn.addEventListener('click', () => this.clearAll());
                this.downloadSampleBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    this.downloadSampleFile();
                });
            }

            downloadSampleFile() {
                // Sample HOI4 log file content
                const sampleContent = `--------------------------------
ALB claim states:
--------------------------------
ALB core states:
44
1268
765
766
--------------------------------
--------------------------------
AST claim states:
634
737
757
--------------------------------
AST core states:
986
285
517
518
519
520
521
987
523
636
674
985
522
988
--------------------------------
--------------------------------
AUS claim states:
--------------------------------
AUS core states:
4
775
836
942
1137
835
152
153
39
783
--------------------------------
--------------------------------
BAS claim states:
--------------------------------
BAS core states:
172
940
--------------------------------
--------------------------------
BAY claim states:
--------------------------------
BAY core states:
780
50
54
53
52
--------------------------------
--------------------------------
BEL claim states:
--------------------------------
BEL core states:
6
741
34
8
7
35
36
866
978
979
--------------------------------
--------------------------------
BRI claim states:
--------------------------------
BRI core states:
14
983
--------------------------------
--------------------------------
CAF claim states:
309
1038
--------------------------------
CAF core states:
308
310
686
687
689
690
691
692
694
695
696
1037
1039
1077
1078
1079
1308
1309
1312
--------------------------------
--------------------------------
CAL claim states:
374
375
833
--------------------------------
CAL core states:
829
798
797
378
385
386
1165
377
379
376
387
1096
1166
380
1157
388
1164
1161
1175
381
1150
389
382
1174
390
384
--------------------------------
--------------------------------
CAN claim states:
326
--------------------------------
CAN core states:
276
464
465
466
467
468
469
470
471
472
473
682
683
739
740
832
1330
1331
1332
--------------------------------
--------------------------------
CAT claim states:
--------------------------------
CAT core states:
165
167
1313
--------------------------------
--------------------------------
CSA claim states:
363
364
365
366
367
369
370
371
372
383
384
1156
1163
1167
1168
1169
1170
--------------------------------
CSA core states:
395
393
396
261
358
359
360
929
1152
1173
930
1159
394
361
391
1162
362
1158
1160
1153
1154
1151
1155
392
389
388
368
373
390
--------------------------------
--------------------------------
CZE claim states:
--------------------------------
CZE core states:
9
69
71
74
75
786
1129
1130
1131
1132
1133
1134
1138
1139
1122
1136
70
664
1120
1121
1123
1135
--------------------------------
--------------------------------
DDR claim states:
--------------------------------
DDR core states:
61
62
63
64
65
66
68
1357
86
67
776
5
188
777
--------------------------------
--------------------------------
DEN claim states:
--------------------------------
DEN core states:
37
99
101
337
926
--------------------------------
--------------------------------
FIN claim states:
--------------------------------
FIN core states:
111
145
146
147
148
149
150
840
844
863
864
865
1324
1325
1326
--------------------------------
--------------------------------
FRP claim states:
28
--------------------------------
FRP core states:
14
15
16
17
983
20
23
24
27
29
30
33
779
785
980
18
--------------------------------
--------------------------------
GBP claim states:
--------------------------------
GBP core states:
123
1315
338
127
126
125
129
128
130
132
1317
--------------------------------
--------------------------------
GLC claim states:
--------------------------------
GLC core states:
171
--------------------------------
--------------------------------
HAW claim states:
--------------------------------
HAW core states:
642
632
631
630
629
726
727
--------------------------------
--------------------------------
HUN claim states:
--------------------------------
HUN core states:
43
1108
155
1107
1111
1106
1110
1109
154
45
70
73
76
82
83
84
664
784
789
875
1112
1113
1114
1115
1116
1117
1118
1119
1120
1121
1122
1123
1135
1136
--------------------------------
--------------------------------
ICE claim states:
--------------------------------
ICE core states:
100
--------------------------------
--------------------------------
IRE claim states:
--------------------------------
IRE core states:
113
119
134
135
--------------------------------
--------------------------------
ITA claim states:
--------------------------------
ITA core states:
159
160
759
783
114
157
158
764
838
1002
1003
1005
1236
161
1004
162
--------------------------------
--------------------------------
NEE claim states:
--------------------------------
NEE core states:
357
796
931
932
933
934
935
358
--------------------------------
--------------------------------
NFL claim states:
--------------------------------
NFL core states:
331
332
730
--------------------------------
--------------------------------
NGF claim states:
--------------------------------
NGF core states:
55
56
57
58
59
60
839
782
--------------------------------
--------------------------------
NOR claim states:
--------------------------------
NOR core states:
110
142
143
144
936
937
1146
1147
--------------------------------
--------------------------------
NRM claim states:
--------------------------------
NRM core states:
15
--------------------------------
--------------------------------
NZL claim states:
--------------------------------
NZL core states:
284
723
--------------------------------
--------------------------------
OCC claim states:
--------------------------------
OCC core states:
19
21
22
25
26
31
32
735
762
763
817
943
984
1334
--------------------------------
--------------------------------
PAP claim states:
--------------------------------
PAP core states:
2
1149
764
--------------------------------
--------------------------------
POL claim states:
93
--------------------------------
POL core states:
10
87
90
92
97
98
1088
1148
11
94
96
189
655
1329
1124
--------------------------------
--------------------------------
SAF claim states:
--------------------------------
SAF core states:
85
275
681
719
738
945
946
947
542
544
950
954
545
541
964
--------------------------------
--------------------------------
SCT claim states:
--------------------------------
SCT core states:
133
121
136
120
938
--------------------------------
--------------------------------
SIC claim states:
--------------------------------
SIC core states:
115
117
156
742
837
1006
--------------------------------
--------------------------------
SPR claim states:
--------------------------------
SPR core states:
178
41
1344
166
168
169
170
173
174
175
176
793
795
1316
951
1336
1337
1338
1339
1340
1341
1342
1343
112
179
180
181
697
698
702
705
--------------------------------
--------------------------------
SRD claim states:
--------------------------------
SRD core states:
114
1002
157
764
1005
1236
1
290
118
116
182
183
177
--------------------------------
--------------------------------
SWE claim states:
--------------------------------
SWE core states:
38
124
138
139
140
141
145
666
778
908
909
960
--------------------------------
--------------------------------
SWI claim states:
--------------------------------
SWI core states:
3
151
760
761
1235
--------------------------------
--------------------------------
WAL claim states:
--------------------------------
WAL core states:
122
1225
--------------------------------
--------------------------------
WGR claim states:
--------------------------------
WGR core states:
42
51
781
--------------------------------`;

                // Create and download the file
                const blob = new Blob([sampleContent], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);

                const a = document.createElement('a');
                a.href = url;
                a.download = 'SampleLogToStateInput.txt';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                this.showStatus('Sample file downloaded successfully!', 'success');
            }

            showStatus(message, type = 'info') {
                this.statusMessage.innerHTML = `<div class="status ${type}">${message}</div>`;
            }


            async convertContent() {
                const content = this.pastedContentTextarea.value.trim();

                if (!content) {
                    this.showStatus('Please load a file or paste content first', 'error');
                    return;
                }

                this.convertBtn.disabled = true;
                this.convertBtn.innerHTML = '<div class="loading"></div>Converting...';
                this.showStatus('Processing content...', 'info');

                try {
                    const jsonResult = this.parseLogContents(content);

                    this.outputTextarea.value = JSON.stringify(jsonResult, null, 2);
                    this.copyBtn.disabled = false;
                    this.showStatus(`Successfully converted ${jsonResult.length} countries!`, 'success');

                } catch (error) {
                    console.error('Conversion error:', error);
                    this.showStatus('Error converting content: ' + error.message, 'error');
                } finally {
                    this.convertBtn.disabled = false;
                    this.convertBtn.innerHTML = 'Convert to JSON';
                }
            }

            parseLogContents(contents) {
                const lines = contents.split('\n');
                const countries = [];
                let currentCountry = null;
                let parsingSection = null; // 'claim' or 'core'

                for (const line of lines) {
                    const cleanLine = line.trim();

                    // Check for country claim states start
                    const claimMatch = cleanLine.match(/^([A-Z]{3}) claim states:$/);
                    if (claimMatch) {
                        if (currentCountry) {
                            countries.push(currentCountry);
                        }
                        currentCountry = {
                            tag: claimMatch[1],
                            claim_state: [],
                            core_state: []
                        };
                        parsingSection = 'claim';
                        continue;
                    }

                    // Check for country core states start
                    const coreMatch = cleanLine.match(/^([A-Z]{3}) core states:$/);
                    if (coreMatch) {
                        if (currentCountry && currentCountry.tag === coreMatch[1]) {
                            parsingSection = 'core';
                        }
                        continue;
                    }

                    // Skip separator lines
                    if (cleanLine === '--------------------------------') {
                        continue;
                    }

                    // Parse state numbers
                    if (currentCountry && parsingSection && /^\d+$/.test(cleanLine)) {
                        const stateId = parseInt(cleanLine);
                        if (parsingSection === 'claim') {
                            currentCountry.claim_state.push(stateId);
                        } else if (parsingSection === 'core') {
                            currentCountry.core_state.push(stateId);
                        }
                    }
                }

                // Add the last country
                if (currentCountry) {
                    countries.push(currentCountry);
                }

                return countries;
            }

            async copyToClipboard() {
                const text = this.outputTextarea.value;

                if (!text) {
                    this.showStatus('No content to copy', 'error');
                    return;
                }

                try {
                    await navigator.clipboard.writeText(text);
                    this.showStatus('JSON copied to clipboard!', 'success');

                    // Reset status after 3 seconds
                    setTimeout(() => {
                        this.statusMessage.innerHTML = '';
                    }, 3000);
                } catch (err) {
                    // Fallback for older browsers
                    this.outputTextarea.select();
                    document.execCommand('copy');
                    this.showStatus('JSON copied to clipboard!', 'success');

                    setTimeout(() => {
                        this.statusMessage.innerHTML = '';
                    }, 3000);
                }
            }

            clearAll() {
                this.pastedContentTextarea.value = '';
                this.outputTextarea.value = '';
                this.copyBtn.disabled = true;
                this.statusMessage.innerHTML = '';
            }
        }

        // Initialize the converter when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            window.hoi4Converter = new HOI4Converter();
        });
    </script>
</body>
</html>
